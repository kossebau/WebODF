<!DOCTYPE HTML>
<html style="width:100%; height:100%; margin:0px; padding:0px" xml:lang="en" lang="en">
  <head>
    <!--
    Example page for how to use the Wodo.CollabTextEditor with OneUserLocalSessionBackend
    -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <title>Wodo.TextEditor</title>

    <!-- dojo setup: start -->
    <script type="text/javascript">
      var usedLocale = "C";
      if (navigator && navigator.language && navigator.language.match(/^(ru|de)/)) {
        usedLocale = navigator.language.substr(0,2);
      }

      dojoConfig = {
        locale: usedLocale,
        paths: {
          "webodf/editor": "wodo",
          "dijit": "wodo/dijit",
          "dojox": "wodo/dojox",
          "dojo":  "wodo/dojo",
          "resources": "wodo/resources"
        }
      }
    </script>

    <script src="wodo/dojo-amalgamation.js" data-dojo-config="async: true"></script>
    <link rel="stylesheet" type="text/css" href="wodo/app/resources/app.css"/>
    <!-- dojo setup: end -->

    <!-- editor: start -->
    <link rel="stylesheet" type="text/css" href="wodo/wodotexteditor.css"/>
    <link rel="stylesheet" type="text/css" href="wodo/wodocollabpane.css"/>
    <script src="wodo/webodf.js" type="text/javascript" charset="utf-8"></script>
    <script src="wodo/wodocollabtexteditor.js" type="text/javascript" charset="utf-8"></script>
    <script src="OneUserLocalSessionBackend.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
        function createEditor() {
            // begin: check for being served by a webserver
            // just done to catch a mistake sometimes done by people testing Wodo.TextEditor
            // who might have missed this requirement before
            var href = window.location.href;
            if (! /^http(s)?:/.test(href)) {
                alert("file must be served by a webserver.");
                return;
            }
            // end: check for being served by a webserver

            var editorOptions = {
                allFeaturesEnabled: true
            };
            function onEditorCreated(err, editor) {
                if (err) {
                    // something failed unexpectedly, deal with it (here just a simple alert)
                    alert(err);
                    return;
                }
                editor.joinSession(new OneUserLocalSessionBackend("welcome.odt"), function(err) {
                    if (err) {
                        // something failed unexpectedly, deal with it (here just a simple alert)
                        alert("There was an error on opening the document: " + err);
                    }
                });
            }
            Wodo.createCollabTextEditor('editorContainer', editorOptions, onEditorCreated);
        }
    </script>
    <!-- editor: end -->
  </head>

  <body style="width:100%; height:100%; margin:0px; padding:0px" onload="createEditor();">
    <div id="editorContainer" style="width:100%; height:100%; margin:0px; padding:0px">
    </div>
  </body>
</html>
